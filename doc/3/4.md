# Volume/Surfaces

Обсудили местоположение и направление. Теперь нам нужно обсудить, как представлять трехмерные формы и площадь, которую они занимают в пространстве. Объектом может быть куб, сфера, плоскость или сложная капля. Объекты принимают бесконечное множество форм. Конечно, можно описать каждый объект уникальным образом, но для этого потребуется уникальный алгоритм визуализации для каждого объекта. Мы хотели бы иметь единообразный способ описания любого типа объекта, независимо от сложности его формы. Вы можете быть удивлены, но почти все алгоритмы рендеринга умеют рендерить только треугольники!

Почему только треугольники?

* Треугольник - это простейшая геометрическая форма, определяющая замкнутую область. Треугольники имеют внутреннюю и внешнюю области.
* Треугольник всегда плоский - он всегда определяет плоскую поверхность.
* Треугольник делит трехмерное пространство на три отдельные области. Все точки в трехмерном пространстве лежат: 1) в плоскости, определяемой треугольником, 2) на одной стороне плоскости или 3) на другой стороне плоскости. Думайте о треугольнике как о плоском листе бумаги. Условно мы можем сказать, что одна сторона треугольника - это лицевая сторона, а другая сторона - обратная сторона. Комбинируя треугольники, мы можем создавать формы, которые имеют внутреннюю и внешнюю стороны.
* Треугольник всегда выпуклый; треугольник не может быть вогнутым. Отрисовка вогнутых многоугольников сложнее, чем выпуклых.

Эти свойства делают рендеринг треугольников простым и быстрым, что делает возможной трехмерную графику в реальном времени!


## Defining Triangles

Треугольники определяются с использованием значений местоположения и направления, которые мы определили в предыдущих уроках.

Любые 3 точки (местоположения) в пространстве определяют треугольник, если эти 3 точки не лежат друг на друге или вдоль линии. Вы можете подумать, что три точки, расположенные друг над другом или вдоль линии, - это редкость, но при манипулировании трехмерными объектами эти условия могут возникать часто. Следовательно, при разработке программного обеспечения для компьютерной графики вы должны постоянно проверять такие случаи. Три точки, которые не определяют допустимый треугольник, называются «вырожденным случаем». Вырожденные случаи проблематичны, потому что они не определяют замкнутую область и не делят трехмерное пространство на 3 области. Но, что, возможно, более важно, вырожденные случаи приводят к сбою математики, которая манипулирует треугольниками. 

Три точки треугольника определяют три ребра или отрезка граничной линии. Три точки - это места пересечения сегментов граничной линии. Точка пересечения двух геометрических объектов называется вершиной. Программное обеспечение для моделирования относится к точкам, которые определяют треугольник, как к вершинам.

Треугольник имеет две стороны: переднюю и заднюю. Поверхность треугольника, заключенную в его края, часто называют гранью треугольника. (Обратите внимание, что «лицо» - это своего рода сокращение от слова «лицо».) Треугольник имеет две грани. Зритель может видеть только одно лицо за раз. Передняя грань видна зрителю, если он находится на передней стороне треугольника. Точно так же задняя грань видна зрителю, только если он находится на обратной стороне треугольника. Это важно, потому что в сцене с одним источником света будет светиться только одна сторона треугольника. Кроме того, только одна сторона треугольника может быть обращена к камере сцены. Для треугольников, которые являются частью более крупного объекта, ориентация лица может использоваться, чтобы определить, видно ли лицо камере.


## WebGL Triangle Rendering Modes

В WebGL вы всегда определяете набор треугольников, используя массив вершин. Есть три различных способа использования вершин для образования треугольников, как показано на диаграмме ниже. Возможные варианты:

* `TRIANGLE` - три вершины для каждого треугольника. Каждая вершина используется для одного треугольника. Вершины, которые используются более чем для одного треугольника, должны повторяться в массиве вершин. Для определения n треугольников требуется 3n вершин.
* `TRIANGLE_STRIP` - после начальных трех вершин каждая дополнительная вершина определяет еще один треугольник. Для определения n треугольников требуется (n + 2) вершин.
* `TRIANGLE_FAN` - все треугольники имеют общую первую вершину. После первых двух вершин каждая новая вершина создает еще один треугольник. Для определения n треугольников требуется (n + 2) вершин.


> Разделение треугольной сетки на наиболее эффективные группы наборов `TRIANGLES`, `TRIANGLE_STRIP` и `TRIANGLE_FAN` - очень сложная проблема. Вы можете сэкономить значительный объем памяти, используя режимы `TRIANGLE_STRIP` и `TRIANGLE_FAN`, но на самом деле они используются редко. 

Рассмотрим очень простой пример. Куб определяется 8 вершинами и 12 треугольниками (6 сторон по 2 треугольника на каждой стороне). Вот много способов визуализации куба, например:

* Используйте режим ТРЕУГОЛЬНИКИ для всех треугольников. Для этого требуется массив из 36 вершин (12 треугольников * 3 вершины / треугольник).
* Используйте 2 массива и режим TRIANGLE_FAN. Один вентилятор начинался с нижнего левого угла; другой вентилятор будет начинаться с правого верхнего угла. Каждый веер нарисовал бы по 6 треугольников. Для этого требуются два массива по 8 вершин в каждом, всего 16 вершин.
* Используйте режим TRIANGLE_STRIP, чтобы нарисовать лицевую, правую, заднюю и левую стороны. Затем используйте 2 режима TRIANGLE_FAN: один для двух верхних граней и один для двух нижних граней. Для этого требуется массив из 10 вершин для TRIANGLE_STRIP и 2 массивов для верха и низа, каждый из которых содержит 4 вершины. Всего 18 вершин.
* И т.д. (Возможны многие другие комбинации.)

Оптимизация треугольных групп для минимизации требований к памяти выходит за рамки этих руководств. Мы ограничимся использованием режима ТРЕУГОЛЬНИКОВ для всех наших визуализаций - за счет использования большего количества RAM и памяти GPU.