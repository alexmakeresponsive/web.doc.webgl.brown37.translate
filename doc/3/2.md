# Modeling Location

## Location Is Relative

Местоположение всегда связано с чем-то другим. Позвольте мне повторить еще раз: «Местоположение всегда относительно!» Например, если вас спросят «Где находится Колорадо-Спрингс?», Типичным ответом может быть «Ну, это в 60 милях к югу от Денвера». Если вы не знаете, где находится Денвер, вам «не повезло».

Итак, нам нужна «точка отсчета» для описания расположения объектов. Мы называем эту точку отсчета **«global origin»**. Слово «глобальный» указывает, что все объекты в сцене расположены относительно этого уникального местоположения.

Кроме того, каждый объект будет иметь **«local origin»**, из которого будут делаться ссылки на местоположения относительно этого объекта. Например, комната будет иметь местное происхождение, которое используется для определения местоположения ее стен и мебели внутри нее; дом будет иметь местное происхождение, которое используется для размещения комнат внутри дома; район будет иметь местное происхождение, которое используется для поиска домов внутри района. И так далее...

Каждый объект в сцене позиционируется путем указания отношения между его локальным и глобальным началом. Обратите внимание, что местоположения всегда связаны между двумя точками.

Эти идеи настолько важны, давайте сформулируем их еще раз:

* Locations are always relative!
* **global origin** - это уникальное место в сцене, из которого расположены все объекты. У сцены ровно одно уникальное **global origin**
* Каждый отдельный объект в сцене имеет свое собственное **local origin**, из которого расположены отдельные части объекта.
* Объекты в сцене позиционируются, определяя взаимосвязь между их **local origin** и **global origin** сцены.

## Describing 2D Locations

Мы могли бы указать местоположение объекта, сказав что-то вроде «это 10 единиц от начала координат».

Но у нас сразу проблема. Существует бесконечное количество точек, удаленных на 10 единиц от начала координат. Все точки, находящиеся на расстоянии 10 единиц от точки, составляют круг!

Чтобы указать уникальное местоположение, мы можем указать, под каким углом мы попадаем в желаемое место. Однако углы, как и местоположения, всегда относительно чего-то. Итак, нам нужна исходная линия для измерения угла. Давайте проведем горизонтальную линию через начало координат. Теперь мы можем определить точное местоположение, используя расстояние от начала координат и угла от нашей исходной линии. Математики называют это описание местоположения «полярными координатами». Если «r» представляет расстояние до местоположения, а «тета» представляет угол, тогда пара (r, theta) описывает уникальное местоположение относительно начала координат и линии отсчета. Было бы неплохо, если бы мы могли избавиться от угла и просто работать с расстояниями.

Одним из вариантов может быть использование расстояния до объекта и расстояния по контрольной линии. Традиционно линия отсчета называется осью x, поэтому наше описание местоположения - это пара расстояний (r, x). Однако это не уникальное описание, поскольку с этими двумя расстояниями связаны две точки.

Так есть ли лучшая пара расстояний, которую можно использовать для определения местоположения точки? Если мы создадим вторую опорную линию, мы сможем использовать расстояние вдоль каждой линии. Вторая линия отсчета может быть в любом направлении, но математику проще, если линия через начало координат и под углом 90 градусов по отношению к исходной линии отсчета. Итак, теперь у нас есть два расстояния для размещения объектов в 2-мерном пространстве. А математика, необходимая для перемещения локаций, проста - это простое добавление.

Обратите внимание, что 2-я линия отсчета, которая традиционно называется осью Y, может быть размещена в двух возможных местах - вверх или вниз. И оказывается, что в компьютерной графике используются **обе** ориентации. Когда мы описываем виртуальные объекты в 2-мерном пространстве, мы будем использовать соглашение **«y вверх»**, потому что это наиболее традиционные математические обозначения для 2-мерного пространства. Когда мы описываем расположение пикселей на экране компьютера, мы будем использовать соглашение **«y вниз»**, потому что почти на всех экранах пиксели располагаются в верхнем левом углу экрана, а ось y идет вниз по левой стороне экрана. Это связано с тем, что исторически экраны компьютеров создавались идентично телевизионным мониторам, и изображение на экране телевизора отображается путем обновления пикселей экрана, начиная с верхнего левого угла, и обновляя слева направо и сверху вниз.

Также обратите внимание, что когда мы изменили описания местоположения с представления (расстояние, угол) на представление (расстояние, расстояние), нам нужно ввести идею отрицательных расстояний. В реальном мире расстояние всегда положительно. В нашем представлении (расстояние, расстояние) отрицательное расстояние означает движение по линии отсчета, но в противоположном направлении. Таким образом, (-2,4) представляет местоположение, как показано на диаграмме справа.


## Describing 3D Locations

Естественным способом описания местоположений в трехмерном пространстве является использование метода картографических и географических приложений с расстоянием и двумя углами. Эти два угла называются долготой и широтой и представляют собой углы от нулевого меридиана и экватора. (Помните, все местоположения относительно чего-то!) Расстояние от уровня моря, которое представляет собой высоту. Высота - это всегда расстояние по линии от центра Земли, поэтому нашей точкой отсчета высоты на самом деле является центр Земли. Любое место в мире можно однозначно описать с помощью трехзначного представления (долгота, широта, высота). Опять же, хотя такое представление является естественным для картографов и пилотов авиалайнеров, использование комбинации двух углов и одного расстояния затрудняет математическое управление местоположениями.

Трехмерными местоположениями будет легче управлять, если они будут представлены в виде трех расстояний вдоль трех линий отсчета. Итак, в трехмерном пространстве мы создаем третью опорную линию, которая проходит через начало координат и находится под углом 90 градусов к двум другим опорным линиям. Это называется осью z. Опять же, у нас есть два варианта направления линии. Линия может выходить «из бумаги» или «уходить в бумагу». Эти два варианта называются «правосторонними» или «левосторонними» системами координат, потому что они могут быть представлены правой или левой рукой человека.

Существует спор о том, какую систему координат следует использовать. Система M**icrosoft Direct3D** использует левостороннюю систему координат, тогда как **WebGL** и большинство инженеров и математиков используют правостороннюю систему координат. На самом деле это не дискуссия, а просто выбор. Важно быть последовательным и всегда использовать одно и то же соглашение. В оставшейся части этих руководств мы будем использовать правостороннюю декартову систему координат для определения местоположений. Локации будут указаны с использованием 3 расстояний по 3 опорным линиям, как показано справа, при этом ось Z всегда направлена к вам за пределы экрана.

## Manipulating Locations

Точкой можно манипулировать, чтобы изменить ее местоположение. В этом суть всей компьютерной графической анимации - изменение местоположения точки с течением времени. Типичные манипуляции включают перемещение, вращение и масштабирование. Мы обсудим детали манипулирования местоположением в Разделе 6.

## WebGL Points

WebGL определяет местоположение в однородных координатах, которое представляет собой 4-компонентное значение - (x, y, z, w). Первые три значения, x, y, z, представляют собой расстояния по осям декартовой системы координат. Последнее значение, w, используется для перспективных расчетов и будет подробно обсуждено позже. **Для наших целей теперь w всегда будет иметь значение 1.0.**

Когда вы описываете модели для программ WebGL, ваша программа может иногда экономить память, сохраняя и указывая только те значения, которые вам нужны, и позволяя WebGL подставлять значения, которые вам не нужны. Например, если вы хотите создать рендеринг 2D-графики, вы можете сохранить значения (x, y), и значение z будет автоматически установлено на ноль.

Для обычных 3-мерных моделей ваша программа будет хранить три значения с плавающей запятой для каждой точки. Компонент w не будет сохранен и всегда будет по умолчанию 1.0. **Для значений с плавающей запятой требуется 4 байта памяти.** Это означает, что для каждой точки модели потребуется 12 байт памяти. WebGL 1.0 требует, чтобы все атрибуты вершин были определены как числа с плавающей запятой.

WebGL поддерживает рендеринг отдельных точек в трехмерном пространстве. Если вы хотите нарисовать одну или несколько точек, вы помещаете точки в массив, а затем вызываете функцию `drawArrays`. Точки будут отображаться как отдельные пиксели на вашем рендеринге. Когда мы будем изучать шейдеры GL позже в этих уроках, вы узнаете, как изменить атрибут точек `gl_PointSize`, чтобы они казались больше при рендеринге.